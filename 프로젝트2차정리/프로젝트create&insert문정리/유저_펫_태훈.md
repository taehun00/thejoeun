-- USERS 테이블 생성
CREATE TABLE USERS (
    userid     NUMBER              PRIMARY KEY,                 -- 사용자 고유 ID
    email      VARCHAR2(200)       NOT NULL UNIQUE,             -- 이메일 주소 (중복 불가)
    nickname   VARCHAR2(100)       NOT NULL,                    -- 닉네임
    password   VARCHAR2(100)       NOT NULL,                    -- 비밀번호
    ufile      VARCHAR2(255)       DEFAULT 'default.png',       -- 이미지 파일 (기본값)
    createdat  DATE                NOT NULL,                    -- 가입일
    mobile     VARCHAR2(200)       UNIQUE                       -- 휴대폰 번호 (NULL 허용, 중복 불가)
);

CREATE SEQUENCE user_seq;


CREATE TABLE AUTHORITIES (
    AUTH    VARCHAR2(100) NOT NULL,
    USERID  NUMBER,
    CONSTRAINT PK_AUTHORITIES PRIMARY KEY (AUTH, USERID),
    CONSTRAINT FK_AUTHORITIES_USERS FOREIGN KEY (USERID)
        REFERENCES USERS (USERID)
);

<!-- 관리자 권한으로 변경
UPDATE authorities
SET auth = 'ROLE_ADMIN'
WHERE userId = 119
  AND auth = 'ROLE_MEMBER';
-->

-- PETTYPE 테이블 생성
CREATE TABLE PETTYPE (
    pettypeid   NUMBER          PRIMARY KEY,         -- 반려동물 종류 ID
    pettypename VARCHAR2(100)   NOT NULL             -- 종류 이름 (강아지, 고양이 등)
);

-- PET 테이블 생성
CREATE TABLE PET (
    petid       NUMBER          PRIMARY KEY,         -- 반려동물 고유 ID
    userid      NUMBER          NOT NULL,            -- 사용자 ID
    petname     VARCHAR2(100)   NOT NULL,            -- 반려동물 이름
    petbreed    VARCHAR2(100)   NOT NULL,            -- 반려동물 종
    birthdate   VARCHAR2(100),                       -- 생년월일
    pettypeid   NUMBER          NOT NULL,            -- 반려동물 종류 ID
    pfile       VARCHAR2(255)   DEFAULT 'default.png', -- 반려동물 이미지파일
    createdat   DATE            NOT NULL,            -- 반려동물 등록일
    CONSTRAINT fk_pet_user FOREIGN KEY (userid)
        REFERENCES USERS(userid),                    -- 사용자 테이블 참조
    CONSTRAINT fk_pet_pettype FOREIGN KEY (pettypeid)
        REFERENCES PETTYPE(pettypeid)                -- 반려동물 종류 테이블 참조
);

-- PET 테이블용 시퀀스 생성
CREATE SEQUENCE pet_seq

