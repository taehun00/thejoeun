<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head lang="ko">
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <title>Header</title>
</head>
<body>

<!-- header fragment 정의 -->
<th:block th:fragment="header">

<!-- 브랜드 -->
<header class="main-header-brand">
  <h1>🐾 Pet Food & Wellness</h1>
  <p>반려동물을 위한 사료·건강 데이터 통합 서비스</p>
</header>

<!-- 메뉴바 -->
<nav class="main-header-nav">
  <a class="logo" th:href="@{/users/mainpage}">HOME</a>

  <div class="menu-right">

    <!-- 공통 메뉴: 로그인 여부와 상관없이 항상 보여줌 -->
    <div>
      <a th:href="@{/petfoodsearcher/searchpetfood}">사료찾기</a>
      <a th:href="@{/reviewboard/reviewlist}">사료리뷰</a>
      <a th:href="@{/smart/smartlist}">운동 스마트</a>
      <a th:href="@{/board/list}">질환 리스트</a>
      <a th:href="@{/faqBoard/faqlist}">고객센터</a>
    </div>

    <!-- 비로그인 -->
    <div sec:authorize="isAnonymous()">
      <a th:href="@{/users/login}">LOGIN</a>
      <a th:href="@{/users/join}">JOIN</a>
      <a class="btn-create" th:href="@{/api/pet/character}">🐶 캐릭터 생성</a>
    </div>

    <!-- 로그인 사용자 -->
    <div sec:authorize="isAuthenticated() and !hasRole('ADMIN')">
      <div class="dropdown">
        <button class="dropdown-toggle">☰</button>
        <div class="dropdown-menu">
          <a th:href="@{/users/mypage}">마이페이지</a>
          <a class="nav-link" th:href="@{/announcements}">알림받기</a>
          <form th:action="@{/users/logout}" method="post">
            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
            <button type="submit">로그아웃</button>
          </form>
        </div>
      </div>
    </div>

    <!-- 관리자 -->
    <div sec:authorize="hasRole('ADMIN')">
      <div class="dropdown admin">
     	 <a href="#" th:onclick="'document.getElementById(\'logoutForm\').submit(); return false;'">로그아웃</a>

		<form id="logoutForm" th:action="@{/users/logout}" method="post" style="display:none;">
		    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
		</form>
        <button class="dropdown-toggle">ADMIN</button>
        <div class="dropdown-menu">
          <a th:href="@{/admin/userList}">USER 관리</a>
          <a th:href="@{/pet/listPetPage}">PET 관리</a>
          <a th:href="@{/admin/announcements}">알림 사항</a>
          <a th:href="@{/foodboard/foodlist.fn}">사료 관리</a>
          <a th:href="@{/info/infoList}">운동 정보 관리</a>
          <a th:href="@{/board/list}">질환 리스트 관리</a>
        </div>
      </div>
    </div>

  </div>
</nav>

</th:block>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
